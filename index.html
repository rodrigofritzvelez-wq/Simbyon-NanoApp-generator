<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Armstrong Monitor - Visual Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, #0a0f1e 0%, #050a14 100%);
      color: #e2e8f0;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Header */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 20px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      background: linear-gradient(135deg, #7c3aed, #06b6d4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 900;
      font-size: 24px;
      color: #0a0f1e;
    }

    h1 {
      font-size: 24px;
      font-weight: 700;
    }

    .subtitle {
      color: #94a3b8;
      font-size: 14px;
    }

    /* Buttons */
    .btn-primary {
      background: linear-gradient(90deg, #7c3aed, #06b6d4);
      border: none;
      padding: 12px 24px;
      border-radius: 10px;
      color: #0a0f1e;
      font-weight: 700;
      cursor: pointer;
      font-size: 14px;
      transition: opacity 0.2s;
    }

    .btn-primary:hover {
      opacity: 0.9;
    }

    .btn-secondary {
      background: #1e293b;
      border: 1px solid #334155;
      padding: 10px 20px;
      border-radius: 8px;
      color: #e2e8f0;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    .btn-secondary:hover {
      background: #334155;
    }

    /* Metrics Grid */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .metric-card {
      background: rgba(30, 41, 59, 0.5);
      backdrop-filter: blur(10px);
      border: 1px solid #334155;
      border-radius: 16px;
      padding: 24px;
      position: relative;
      overflow: hidden;
    }

    .metric-card.purple {
      border-color: rgba(124, 58, 237, 0.3);
      background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), rgba(124, 58, 237, 0.05));
    }

    .metric-card.cyan {
      border-color: rgba(6, 182, 212, 0.3);
      background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(6, 182, 212, 0.05));
    }

    .metric-card.green {
      border-color: rgba(74, 222, 128, 0.3);
      background: linear-gradient(135deg, rgba(74, 222, 128, 0.1), rgba(74, 222, 128, 0.05));
    }

    .metric-card.pink {
      border-color: rgba(236, 72, 153, 0.3);
      background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), rgba(236, 72, 153, 0.05));
    }

    .metric-label {
      font-size: 14px;
      color: #94a3b8;
      margin-bottom: 8px;
    }

    .metric-value {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: rgba(15, 23, 42, 0.5);
      border-radius: 3px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #06b6d4, #7c3aed);
      border-radius: 3px;
      transition: width 0.5s ease;
    }

    /* Main Grid */
    .main-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    @media (max-width: 1024px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: rgba(30, 41, 59, 0.5);
      backdrop-filter: blur(10px);
      border: 1px solid #334155;
      border-radius: 16px;
      padding: 24px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Network Visualization */
    .network-container {
      background: rgba(15, 23, 42, 0.5);
      border-radius: 12px;
      height: 400px;
      position: relative;
      overflow: hidden;
    }

    #networkCanvas {
      width: 100%;
      height: 100%;
    }

    .controls {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    /* Charts */
    .charts-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      .charts-grid {
        grid-template-columns: 1fr;
      }
    }

    .chart-container {
      background: rgba(15, 23, 42, 0.5);
      border-radius: 12px;
      padding: 20px;
      height: 150px;
      position: relative;
    }

    .chart-label {
      font-size: 12px;
      color: #94a3b8;
      margin-bottom: 10px;
    }

    canvas {
      width: 100%;
      height: 100%;
    }

    /* Events Stream */
    .events-container {
      height: 500px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .events-container::-webkit-scrollbar {
      width: 6px;
    }

    .events-container::-webkit-scrollbar-track {
      background: rgba(15, 23, 42, 0.5);
      border-radius: 3px;
    }

    .events-container::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 3px;
    }

    .event-item {
      background: rgba(51, 65, 85, 0.3);
      border: 1px solid rgba(51, 65, 85, 0.5);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 10px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .event-time {
      font-size: 11px;
      color: #64748b;
      margin-bottom: 6px;
    }

    .event-text {
      font-size: 14px;
    }

    /* Timeline */
    .timeline-container {
      max-height: 300px;
      overflow-y: auto;
      padding-right: 10px;
      margin-bottom: 15px;
    }

    .timeline-item {
      border-left: 2px solid #7c3aed;
      padding-left: 15px;
      margin-bottom: 15px;
      padding-bottom: 10px;
    }

    .input-group {
      display: flex;
      gap: 10px;
    }

    input {
      flex: 1;
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 8px;
      padding: 10px 15px;
      color: #e2e8f0;
      font-size: 14px;
    }

    input:focus {
      outline: none;
      border-color: #7c3aed;
    }

    /* Nodes Table */
    .nodes-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .nodes-table th {
      background: rgba(15, 23, 42, 0.5);
      padding: 12px;
      text-align: left;
      font-size: 12px;
      color: #94a3b8;
      font-weight: 600;
      border-bottom: 1px solid #334155;
    }

    .nodes-table td {
      padding: 12px;
      border-bottom: 1px solid rgba(51, 65, 85, 0.3);
      font-size: 14px;
    }

    .nodes-table tr:hover {
      background: rgba(51, 65, 85, 0.2);
    }

    .status-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-dot.active {
      background: #4ade80;
      box-shadow: 0 0 10px #4ade80;
    }

    .status-dot.idle {
      background: #64748b;
    }

    .archetype-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
    }

    .activity-bar {
      width: 100%;
      height: 6px;
      background: #1e293b;
      border-radius: 3px;
      overflow: hidden;
    }

    .activity-fill {
      height: 100%;
      background: linear-gradient(90deg, #7c3aed, #06b6d4);
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    .chart-value {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 28px;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header>
      <div class="brand">
        <div class="logo">S</div>
        <div>
          <h1>Armstrong Monitor</h1>
          <div class="subtitle">Observaci√≥n Simbyon Core (alpha)</div>
        </div>
      </div>
      <button class="btn-primary" onclick="startTest()">üöÄ Start Silent Alpha</button>
    </header>

    <!-- Metrics Cards -->
    <div class="metrics-grid">
      <div class="metric-card green">
        <div class="metric-label">‚ö° Nodes Activos</div>
        <div class="metric-value"><span id="activeNodes">0</span>/<span id="totalNodes">0</span></div>
      </div>
      <div class="metric-card purple">
        <div class="metric-label">‚ö° Pulsos Totales</div>
        <div class="metric-value" id="totalPulses">0</div>
      </div>
      <div class="metric-card cyan">
        <div class="metric-label">üìä Resonancia</div>
        <div class="metric-value" id="resonanceValue">0%</div>
        <div class="progress-bar">
          <div class="progress-fill" id="resonanceBar" style="width: 0%"></div>
        </div>
      </div>
      <div class="metric-card pink">
        <div class="metric-label">üìà Retenci√≥n</div>
        <div class="metric-value" id="retentionValue">0%</div>
        <div class="progress-bar">
          <div class="progress-fill" id="retentionBar" style="width: 0%"></div>
        </div>
      </div>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
      <!-- Left Column -->
      <div>
        <!-- Network Visualization -->
        <div class="card">
          <div class="card-title">üåê Red de Nodos</div>
          <div class="network-container">
            <canvas id="networkCanvas"></canvas>
          </div>
          <div class="controls">
            <button class="btn-secondary" onclick="seedNodes()">üå± Seed 10 nodes</button>
            <button class="btn-secondary" onclick="sendPulse()">‚ö° Send Pulse</button>
            <button class="btn-secondary" onclick="forceMutation()">üß¨ Force Mutation</button>
          </div>
        </div>

        <!-- Charts -->
        <div class="charts-grid">
          <div class="card">
            <div class="chart-label">Historial de Pulsos</div>
            <div class="chart-container">
              <canvas id="pulseChart"></canvas>
              <div class="chart-value" id="pulseChartValue" style="color: #7c3aed;">0</div>
            </div>
          </div>
          <div class="card">
            <div class="chart-label">Evoluci√≥n Resonancia</div>
            <div class="chart-container">
              <canvas id="resonanceChart"></canvas>
              <div class="chart-value" id="resonanceChartValue" style="color: #06b6d4;">0%</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column -->
      <div>
        <!-- Events Stream -->
        <div class="card">
          <div class="card-title">üì° Events Stream</div>
          <div class="events-container" id="eventsContainer"></div>
        </div>

        <!-- Timeline -->
        <div class="card" style="margin-top: 20px;">
          <div class="card-title">üìù Timeline & Notes</div>
          <div class="timeline-container" id="timelineContainer"></div>
          <div class="input-group">
            <input type="text" id="noteInput" placeholder="Nota breve..." onkeypress="if(event.key==='Enter') addNote()">
            <button class="btn-primary" onclick="addNote()">Add</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Nodes Table -->
    <div class="card">
      <div class="card-title">üìä Tabla de Nodos</div>
      <table class="nodes-table" id="nodesTable">
        <thead>
          <tr>
            <th>Node</th>
            <th>Arquetipo</th>
            <th>Status</th>
            <th>Interacciones</th>
            <th>Actividad</th>
          </tr>
        </thead>
        <tbody id="nodesTableBody"></tbody>
      </table>
    </div>
  </div>

  <script>
    // State
    let nodes = [];
    let events = [];
    let timeline = [];
    let metrics = {
      pulses: 0,
      interactions: 0,
      mutations: 0,
      resonance: 0,
      retention: 0
    };
    let pulseHistory = [];
    let resonanceHistory = [];

    const archetypes = ['Cuidador Solar', 'Art√≠fice', 'Guardi√°n', 'Tejedor', 'Explorador', 'Sacerdote', 'Curador', 'Navegante'];
    const colors = ['#4ade80', '#06b6d4', '#7c3aed', '#f59e0b', '#ec4899', '#10b981', '#3b82f6', '#8b5cf6'];

    // Network Canvas
    const networkCanvas = document.getElementById('networkCanvas');
    const ctx = networkCanvas.getContext('2d');

    function resizeCanvas() {
      networkCanvas.width = networkCanvas.offsetWidth;
      networkCanvas.height = networkCanvas.offsetHeight;
      drawNetwork();
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // Functions
    function seedNodes() {
      nodes = [];
      for (let i = 1; i <= 10; i++) {
        nodes.push({
          id: i,
          handle: `simbionte-${i}`,
          archetype: archetypes[Math.floor(Math.random() * archetypes.length)],
          status: 'idle',
          interactions: 0,
          color: colors[(i - 1) % colors.length]
        });
      }
      addEvent('üå± Seeded 10 nodes - Sistema inicializado');
      updateUI();
    }

    function sendPulse() {
      if (nodes.length === 0) {
        addEvent('‚ö†Ô∏è No hay nodes: ejecuta seed primero');
        return;
      }

      const randomNode = nodes[Math.floor(Math.random() * nodes.length)];
      randomNode.status = 'active';
      randomNode.interactions++;

      metrics.pulses++;
      metrics.interactions++;
      metrics.resonance = Math.min(100, Math.round(metrics.pulses / 2));
      metrics.retention = Math.min(100, Math.round(metrics.interactions / 3));

      pulseHistory.push(metrics.pulses);
      if (pulseHistory.length > 20) pulseHistory.shift();

      resonanceHistory.push(metrics.resonance);
      if (resonanceHistory.length > 20) resonanceHistory.shift();

      addEvent(`‚ú® ${randomNode.handle} envi√≥ pulso ‚Üí red activada`);
      updateUI();
      updateCharts();
    }

    function forceMutation() {
      metrics.mutations++;
      addEvent('üß¨ Mutaci√≥n forzada - Ontolog√≠a actualizada');
      updateUI();
    }

    function startTest() {
      seedNodes();
      addEvent('üöÄ Silent Alpha iniciado - Observando 10 nodes');
    }

    function addEvent(text) {
      const event = {
        id: Date.now(),
        text: text,
        time: new Date().toLocaleTimeString()
      };
      events.unshift(event);
      if (events.length > 50) events.pop();
      renderEvents();
    }

    function addNote() {
      const input = document.getElementById('noteInput');
      const text = input.value.trim();
      if (!text) return;

      timeline.unshift({
        id: Date.now(),
        text: text,
        time: new Date().toLocaleTimeString()
      });
      input.value = '';
      renderTimeline();
    }

    function renderEvents() {
      const container = document.getElementById('eventsContainer');
      container.innerHTML = events.map(e => `
        <div class="event-item">
          <div class="event-time">${e.time}</div>
          <div class="event-text">${e.text}</div>
        </div>
      `).join('');
    }

    function renderTimeline() {
      const container = document.getElementById('timelineContainer');
      container.innerHTML = timeline.map(t => `
        <div class="timeline-item">
          <div class="event-time">${t.time}</div>
          <div class="event-text">${t.text}</div>
        </div>
      `).join('');
    }

    function updateUI() {
      // Update metrics
      const activeCount = nodes.filter(n => n.status === 'active').length;
      document.getElementById('activeNodes').textContent = activeCount;
      document.getElementById('totalNodes').textContent = nodes.length;
      document.getElementById('totalPulses').textContent = metrics.pulses;
      document.getElementById('resonanceValue').textContent = metrics.resonance + '%';
      document.getElementById('retentionValue').textContent = metrics.retention + '%';
      document.getElementById('resonanceBar').style.width = metrics.resonance + '%';
      document.getElementById('retentionBar').style.width = metrics.retention + '%';

      // Update table
      const tbody = document.getElementById('nodesTableBody');
      tbody.innerHTML = nodes.map(node => `
        <tr>
          <td><strong>${node.handle}</strong></td>
          <td>
            <span class="archetype-badge" style="background: ${node.color}20; color: ${node.color}">
              ${node.archetype}
            </span>
          </td>
          <td>
            <span class="status-dot ${node.status}"></span>
            ${node.status}
          </td>
          <td>${node.interactions}</td>
          <td>
            <div class="activity-bar">
              <div class="activity-fill" style="width: ${Math.min(100, node.interactions * 10)}%"></div>
            </div>
          </td>
        </tr>
      `).join('');

      drawNetwork();
    }

    function drawNetwork() {
      ctx.clearRect(0, 0, networkCanvas.width, networkCanvas.height);

      const centerX = networkCanvas.width / 2;
      const centerY = networkCanvas.height / 2;
      const radius = Math.min(centerX, centerY) - 60;

      // Draw connections
      nodes.forEach((node, i) => {
        const angle = (i / nodes.length) * 2 * Math.PI - Math.PI / 2;
        const x = centerX + Math.cos(angle) * radius;
        const y = centerY + Math.sin(angle) * radius;

        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.lineTo(x, y);
        ctx.strokeStyle = node.status === 'active' ? node.color + '60' : '#334155';
        ctx.lineWidth = node.status === 'active' ? 2 : 1;
        ctx.stroke();
      });

      // Draw center hub
      ctx.beginPath();
      ctx.arc(centerX, centerY, 30, 0, 2 * Math.PI);
      const gradient = ctx.createLinearGradient(centerX - 30, centerY - 30, centerX + 30, centerY + 30);
      gradient.addColorStop(0, '#7c3aed');
      gradient.addColorStop(1, '#06b6d4');
      ctx.fillStyle = gradient;
      ctx.fill();

      // Draw nodes
      nodes.forEach((node, i) => {
        const angle = (i / nodes.length) * 2 * Math.PI - Math.PI / 2;
        const x = centerX + Math.cos(angle) * radius;
        const y = centerY + Math.sin(angle) * radius;

        // Node circle
        ctx.beginPath();
        ctx.arc(x, y, 20, 0, 2 * Math.PI);
        ctx.fillStyle = node.status === 'active' ? node.color + '40' : '#1e293b';
        ctx.fill();
        ctx.strokeStyle = node.color;
        ctx.lineWidth = 2;
        ctx.stroke();

        // Node number
        ctx.fillStyle = '#e2e8f0';
        ctx.font = 'bold 14px Inter';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(node.id, x, y);

        // Glow effect for active nodes
        if (node.status === 'active') {
          ctx.beginPath();
          ctx.arc(x, y, 25, 0, 2 * Math.PI);
          ctx.strokeStyle = node.color + '40';
          ctx.lineWidth = 3;
          ctx.stroke();
        }
      });
    }

    // Charts
    function updateCharts() {
      drawLineChart('pulseChart', pulseHistory, '#7c3aed');
      drawLineChart('resonanceChart', resonanceHistory, '#06b6d4');
      
      document.getElementById('pulseChartValue').textContent = pulseHistory[pulseHistory.length - 1] || 0;
      document.getElementById('resonanceChartValue').textContent = (resonanceHistory[resonanceHistory.length - 1] || 0) + '%';
    }

    function drawLineChart(canvasId, data, color) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');
      
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      if (data.length === 0) return;
      
      const max = Math.max(...data, 1);
      const padding = 10;
      const chartWidth = canvas.width - padding * 2;
      const chartHeight = canvas.height - padding * 2;
      
      // Draw line
      ctx.beginPath();
      data.forEach((val, i) => {
        const x = padding + (i / (data.length - 1)) * chartWidth;
        const y = padding + chartHeight - (val / max) * chartHeight;
        
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.strokeStyle = color;
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // Draw area
      ctx.lineTo(padding + chartWidth, padding + chartHeight);
      ctx.lineTo(padding, padding + chartHeight);
      ctx.closePath();
      ctx.fillStyle = color + '20';
      ctx.fill();
    }

    // Animation loop for network
    setInterval(() => {
      if (nodes.length > 0) {
        drawNetwork();
      }
    }, 2000);
  </script>
</body>
</html>
